<!-- github website hosted at:  https://jstrom2002.github.io/PersonalWebsite/ -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes"/>
    <meta name="theme-color" content="#000000" />
    <link rel="manifest"  crossorigin="use-credentials" href="./manifest.json" />
    <title>Jeff Strom</title>
    <link rel="stylesheet" href="index.css">
    <!--      ////////////////////////////////////////////      -->
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="portfolio.html">Portfolio</a></li>
        <li class="active"><a href="contact.html">Contact</a></li>
        <li><a href="resume.htm">Resume</a></li>
    </ul>

    <script type="text/javascript">
        var data = [];
        var svgOne;
        var startValue = 2;
        var endValue =  19;

        function updateGraph1() {
            if(document.getElementById("button1").checked){filenamestr = "weather-persons.csv";}
            if(document.getElementById("button2").checked){filenamestr = "weather-injured.csv";}
            if(document.getElementById("button3").checked){filenamestr = "weather-fatalities.csv";}
            console.log(startValue,endValue);
            data = [];

            // set the dimensions and margins of the graph
            var margin = {top: 20, right: 20, bottom: 40, left: 320},
                width = 960 - margin.left - margin.right,
                height = 500 - margin.top - margin.bottom;

            // set the ranges
            var x = d3.scaleBand()
                .range([0, height])
                .padding(0.1);
            var y = d3.scaleLinear()
                .range([width / 1.0, 0]);

            // append the svg object to the body of the page
            // append a 'group' element to 'svg'
            // moves the 'group' element to the top left margin
            if (svgOne == null) {
                svgOne = d3.select("#charts").append("svg")
                    .attr("width", (width / 1.0) + margin.left + margin.right)
                    .attr("height", (height / 1.2) + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
            }

            // get the data
            d3.request("")
                .mimeType("text/csv")
                .get(function (response) {
                    let rows = d3.csvParseRows(response.responseText);

                    for (let i = 2; i < rows.length; i++) {
                        let weather = rows[i][0];
                        let number = 0;

                        for (let j = startValue; j <= endValue; j++) {
                            let number2 = rows[i][j];

                            if (number2) {
                                number2 = parseInt(number2);
                            } else {
                                number2 = 0;
                            }
                            number += number2;
                        }
                        number = Math.log2(number);
                        data[i - 2] = {
                            "weather": weather,
                            "number": number
                        };
                    }
                    data.sort(function (a, b) {
                        return b.number - a.number
                    });

                    // Scale the range of the data in the domains
                    x.domain(data.map(function (d) {
                        return d.weather;
                    }));
                    y.domain([0, d3.max(data, function (d) {
                        return d.number;
                    })]);

                    // append the rectangles for the bar chart
                    svgOne.selectAll(".bar")
                        .remove()
                        .exit()
                        .data(data)
                        .enter().append("rect")
                        .attr("class", "bar")
                        .attr("x", function (d) {
                            return x(d.weather) / 1.25;
                        })
                        .attr("width", x.bandwidth() / 1.25)
                        .attr("y", function (d) {
                            return y(d.number) - 30;
                        })
                        .attr("height", function (d) {
                            return Math.abs(height - y(d.number));
                        })
                        .attr("fill", function (d) {
                            if (d.weather === "Clear and sunny") {
                                return "#0000aa";
                            } else {
                                return "#cccccc";
                            }
                        })
                        .attr("transform", "translate(10, 0) scale(1 1) rotate(90 200 200)");

                    // add the y Axis
                    if(svgOne.select("g").empty()) {
                        svgOne.append("g")
                            .attr("transform", "rotate(0 0 0) scale(1 0.8) translate(0 0)")
                            .attr("stroke", "lightgrey")
                            .style("font", "16px arial")
                            .call(d3.axisLeft(x));
                    }else{
                        svgOne.select("g").remove().exit();
                        svgOne.append("g")
                            .attr("transform", "rotate(0 0 0) scale(1 0.8) translate(0 0)")
                            .attr("stroke", "lightgrey")
                            .style("font", "16px arial")
                            .call(d3.axisLeft(x));
                    }

                    // add the x Axis
                    /*    svgOne.append("g")
                            .attr("transform", "rotate(90 200 200)")
                            .attr("transform", "scale(1, 1) translate(0 "+ height +")")
                            .call(d3.axisBottom(y));    */

                    svgOne.append("text")
                        .attr("x", (height / 2))
                        .attr("y", 0)
                        .attr("text-anchor", "middle")
                        .attr("font-family", "sans-serif")
                        .attr("stroke", "lightgrey")
                        .attr("font-size", "18px")
                        .text("Accidents by Weather");
                });

        }

    </script>

</head>
<body>

<div id="Div1">

    <div className="textIntroduction" id="textIntroduction">
    <pre class="introText" id="introText">
        Desktop
    </pre>
    </div>

</div>



<script src="//d3js.org/d3.v4.min.js"></script>

</body>
</html>